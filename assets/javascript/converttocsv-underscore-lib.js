var CSV={delimiter:",",detectedDelimiter:",",autodetect:!0,quote:'"',limit:"",isFirstRowHeader:!0,headerToUpper:!1,headerToLower:!1,skipEmptyRows:!0,relaxedMode:!0,ignoreQuote:!1,excelMode:!0,sortNeeded:!1,maxColumnsFound:0,prevColumnsFound:0,dataRowsFound:0,arHeaderRow:[],table:[],statsCnt:[],displayPoss:"",sortPoss:"",sortIgnoreCase:!1,parse:function(e,t){var n,r="",a="";t=t||function(e,t,n){return n},this.table=[],this.statsCnt=[],this.arHeaderRow=[],this.maxColumnsFound=0,this.dataRowsFound=0;var o,i,l,s,u=e.split(""),c=0,d=u.length,f=0;for(""!=this.limit&&isNaN(this.limit)&&(this.limit=""),detect={comma:0,semi:0,tab:0,pipe:0,colon:0,space:0},n=0;n<d&&(!(1<n)||"\r"!=u[n]&&"\n"!=u[n]);n++)","==u[n]&&detect.comma++,";"==u[n]&&detect.semi++,"\t"==u[n]&&detect.tab++,"|"==u[n]&&detect.pipe++,":"==u[n]&&detect.colon++," "==u[n]&&detect.space++;for(this.detectedDelimiter=this.delimiter,detect.tab>=detect.comma&&detect.tab>=detect.pipe&&detect.tab>=detect.semi&&detect.tab>=detect.colon?this.detectedDelimiter="\t":detect.semi>detect.comma&&detect.semi>detect.pipe&&detect.semi>detect.tab&&detect.semi>detect.colon?this.detectedDelimiter=";":detect.colon>detect.comma&&detect.colon>detect.pipe&&detect.colon>detect.tab&&detect.colon>detect.semi?this.detectedDelimiter=":":detect.pipe>detect.comma&&detect.pipe>detect.semi&&detect.pipe>detect.tab&&detect.pipe>detect.colon?this.detectedDelimiter="|":detect.comma>detect.tab&&detect.comma>detect.pipe&&detect.comma>detect.semi&&detect.comma>detect.colon&&(this.detectedDelimiter=","),0==detect.tab&&0==detect.comma&&0==detect.pipe&&0==detect.colon&&0==detect.semi&&0<detect.space&&(this.detectedDelimiter=" "),this.autodetect&&(this.delimiter=this.detectedDelimiter);c<d;)if(!this.skipEmptyRows||"\r"!=u[c]&&"\n"!=u[c]){for(this.table.push(l=[]);c<d&&"\r"!==u[c]&&"\n"!==u[c];){if(s=o=i=c,this.relaxedMode){for(;" "===u[c];)++c;u[c]!==this.quote||this.ignoreQuote?c=s:o=c}if(this.excelMode&&"="===u[c]&&c+1<d&&u[c+1]===this.quote&&(o=++c,!0),this.quote!==u[c]||this.ignoreQuote)for(;c<d&&"\r"!==u[c]&&"\n"!==u[c]&&this.delimiter!==u[c];)i=++c;else{for(o=i=++c;c<d;){if(this.quote===u[c]){if(this.quote!==u[c+1])break;u[++c]=""}i=++c}for(this.quote===u[c]&&++c;c<d&&"\r"!==u[c]&&"\n"!==u[c]&&this.delimiter!==u[c];)++c}if(l.push(t(this.table.length-1,l.length,u.slice(o,i).join("")))," "==this.delimiter)for(;c<d&&u[c]==this.delimiter;)++c;this.delimiter===u[c]&&++c}if(u[c-1]==this.delimiter&&" "!=this.delimiter&&l.push(t(this.table.length-1,l.length,"")),l.length>this.maxColumnsFound&&(this.maxColumnsFound=l.length),"\r"===u[c]&&++c,"\n"===u[c]&&++c,!this.isFirstRowHeader||0<f)for(n=0;n<l.length;n++){if((n>=this.statsCnt.length||0==f)&&(this.statsCnt[n]={dateCnt:0,intCnt:0,realCnt:0,emptyCnt:0,bitCnt:0,equalUsed:!1,fieldType:"",fieldDecs:0,fieldPrec:0,fldMinLen:Number.MAX_VALUE,fldMaxLen:0}),r=l[n].replace(/^\s+|\s+$/g,""),this.excelMode&&2<r.length&&'="'===r.substr(0,2)&&'"'===r.substr(r.length-1)){this.statsCnt[n].equalUsed=!0;var p=new RegExp(this.quote+this.quote,"gmi");r=l[n]=r.substr(2,r.length-3).replace(p,this.quote)}if(""==r?this.statsCnt[n].emptyCnt++:(r.length<this.statsCnt[n].fldMinLen&&(this.statsCnt[n].fldMinLen=r.length),r.length>this.statsCnt[n].fldMaxLen&&(this.statsCnt[n].fldMaxLen=r.length)),""!=(a=r)&&a.isNumeric()){this.statsCnt[n].realCnt++;var h=a.split(".");h[0].length>this.statsCnt[n].fieldPrec&&(this.statsCnt[n].fieldPrec=h[0].length),1<h.length&&h[1].length>this.statsCnt[n].fieldDecs&&(this.statsCnt[n].fieldDecs=h[1].length),r.indexOf(".")<0&&this.statsCnt[n].intCnt++,"0"!==r&&"1"!==r||this.statsCnt[n].bitCnt++}r.isDateMaybe()&&this.statsCnt[n].dateCnt++}if(f++,""!=this.limit&&f-(this.isFirstRowHeader?1:0)>=1*this.limit)break}else c++;if(this.dataRowsFound=f-(this.isFirstRowHeader?1:0),this.isFirstRowHeader&&0<this.table.length)for(this.arHeaderRow=this.table.shift(),n=0;n<this.maxColumnsFound;n++)this.arHeaderRow[n]&&""!=this.arHeaderRow[n]||(this.arHeaderRow[n]="FIELD"+(n+1)),this.arHeaderRow[n]=this.arHeaderRow[n].trim();if(0<this.arHeaderRow.length)for(n=0;n<this.arHeaderRow.length;n++)this.determineCsvColType(n);else if(0<this.table.length)for(n=0;n<this.maxColumnsFound;n++)this.arHeaderRow[n]&&""!=this.arHeaderRow[n]||(this.arHeaderRow[n]="FIELD"+(n+1)),this.determineCsvColType(n);for(n=0;n<this.arHeaderRow.length;n++)this.headerToUpper&&(this.arHeaderRow[n]=this.arHeaderRow[n].toUpperCase()),this.headerToLower&&(this.arHeaderRow[n]=this.arHeaderRow[n].toLowerCase());return""!=this.sortPoss&&this.table.sort(this.sortCsv),0},setSortFlds:function(e){CSV.sortPoss=e.trim()},sortCsv:function(e,t){if(""==CSV.sortPoss)return 0;var n=[],r=[],a=[];for(n=CSV.sortPoss.split(","),j=0;j<n.length;j++)switch(r[j]=1,a[j]="","D"==n[j].right(1).toUpperCase()&&(r[j]=-1,n[j]=n[j].left(n[j].length-1)),n[j].left(1).toUpperCase()){case"C":a[j]="C",n[j]=n[j].right(n[j].length-1);break;case"N":a[j]="N",n[j]=n[j].right(n[j].length-1)}for(j=0;j<n.length;j++)isNaN(n[j])?n[j]=-1:n[j]=1*n[j]-1;for(j=0;j<n.length;j++)n[j]>=e.length&&(n[j]=-1);for(j=0;j<n.length;j++)if(!(n[j]<0))if(isNaN(e[n[j]].replace(/[\$,]/g,""))||isNaN(t[n[j]].replace(/[\$,]/g,""))||CSV.dataRowsFound!=CSV.statsCnt[n[j]].realCnt+CSV.statsCnt[n[j]].emptyCnt||"C"==a[j])if(CSV.sortIgnoreCase){if(e[n[j]].toUpperCase()<t[n[j]].toUpperCase())return-1*r[j];if(e[n[j]].toUpperCase()>t[n[j]].toUpperCase())return 1*r[j]}else{if(e[n[j]]<t[n[j]])return-1*r[j];if(e[n[j]]>t[n[j]])return 1*r[j]}else{if(1*e[n[j]].replace(/[\$,]/g,"")<1*t[n[j]].replace(/[\$,]/g,""))return-1*r[j];if(1*e[n[j]].replace(/[\$,]/g,"")>1*t[n[j]].replace(/[\$,]/g,""))return 1*r[j]}return 0},determineCsvColType:function(e){return 0==this.table.length?"":(e>=this.statsCnt.length&&(this.statsCnt[e]={dateCnt:0,intCnt:0,realCnt:0,emptyCnt:0,bitCnt:0,fieldType:""}),this.table.length==this.statsCnt[e].bitCnt?this.statsCnt[e].fieldType="B":this.table.length==this.statsCnt[e].dateCnt?this.statsCnt[e].fieldType="D":this.table.length==this.statsCnt[e].intCnt?this.statsCnt[e].fieldType="I":this.table.length==this.statsCnt[e].realCnt?this.statsCnt[e].fieldType="N":0<this.statsCnt[e].bitCnt&&this.table.length==this.statsCnt[e].bitCnt+this.statsCnt[e].emptyCnt?this.statsCnt[e].fieldType="B":0<this.statsCnt[e].dateCnt&&this.table.length==this.statsCnt[e].dateCnt+this.statsCnt[e].emptyCnt?this.statsCnt[e].fieldType="D":0<this.statsCnt[e].intCnt&&this.table.length==this.statsCnt[e].intCnt+this.statsCnt[e].emptyCnt?this.statsCnt[e].fieldType="I":0<this.statsCnt[e].realCnt&&this.table.length==this.statsCnt[e].realCnt+this.statsCnt[e].emptyCnt?this.statsCnt[e].fieldType="N":this.statsCnt[e].fieldType="VC")},stringify:function(e,t){t=t||function(e,t,n){return n};var n,r,a,o,i="",l=e.length;for(a=0;a<l;++a)for(a&&(i+="\r\n"),n=0,r=e[a].length;n<r;++n)n&&(i+=this.delimiter),o=t(a,n,e[a][n]),/[,\r\n"]/.test(o)&&(o=this.quote+o.replace(/"/g,this.quote+this.quote)+this.quote),i+=o||0===o?o:"";return i}},csvRedQuery;function SeqObj(e){this.n=e-1||0,this.nInit=this.n,this.next=function(){return++this.n},this.curr=function(){return this.n},this.reset=function(){this.n=this.nInit}}function temGetVal(oCsv,s,rownum,seq){var j,k;oCsv=oCsv||CSV;var rn=rownum+1,nr=oCsv.table.length,nh=oCsv.arHeaderRow.length,nf=0,br="\n",lb="{",rb="}",tab="    ";for(k=0;k<oCsv.maxColumnsFound;k++)eval("var f"+(k+1)+"=''"),eval("var h"+(k+1)+"=''");for(k=0;k<oCsv.arHeaderRow.length;k++)eval("var h"+(k+1)+"=oCsv.arHeaderRow[k]");if(0<=rownum)for(k=0;k<oCsv.table[rownum].length;k++)eval("var f"+(k+1)+"=oCsv.table[rownum][k]");nf=0<=rownum?oCsv.table[rownum].length:0;var a=s.split("."),b;for(j=0;j<a.length;j++)b=a[j].trim().split("("),"csv"==b[0].trim().toLowerCase()&&1<b.length&&")"===b[1].trim()&&(a[j]="csv("+oCsv.quote.enclose('"',"\\")+","+oCsv.quote.enclose('"',"\\")+")");try{return eval(a.join("."))}catch(e){return""}}function temHandler(e,t,n,r){if(e=e||CSV,""==t.trim())return t;var a=(t=t.replace(/\r\n|\r|\n/g,"{br}").replace(/{\s/g,"{lb} ").replace(/{$/g,"{lb}").replace(/\s}/g," {rb}").replace(/^}/g,"{rb}")).replace(/{/g,"{\n").split(/{|}/).join("\n"),o=0,i=!1;lines=a.split("\n");for(var l=[];o<lines.length;)i&&""!=lines[o]?(l.push(temGetVal(e,lines[o],n,r)),i=!1):""==lines[o]?i=!0:l.push(lines[o]),o++;return l.join("")}function csvFromTem(e,t,n,r,a,o){var i;e=e||CSV;var l="",s=new SeqObj;for(l+=temHandler(e,t,-1,0),i=0;i<e.table.length;i++)"false"!=temHandler(e,o,i,i).toString().left(5)&&(l+=temHandler(e,n,i,s.next()),i!=e.table.length-1&&(l+=temHandler(e,r,i,s.curr())));return l+=temHandler(e,a,-1,s.curr())}function csvToTable(e,t,n,r){var a,o,i,l='<div class="row"><div class="col-md-12"><div class="panel panel-success"><div class="panel-heading "><h3 class="panel-title">CSV Preview</h3></div><table class="table table-striped table-bordered table-hover table-condensed">\n',s=0,u="",c=[];for(i=getFldPosArr(e=e||CSV),o=0;o<e.maxColumnsFound;o++)c.push(0);if(e.isFirstRowHeader||t){for(l+="<thead><tr>",n&&(l+="<th>#</th>"),s=0;s<i.length;s++)l+='<th title="Field #'+((o=i[s]-1)+1)+'">'+(u=o>e.arHeaderRow.length?"FIELD"+o:e.arHeaderRow[o]).toHtml().replace(/\r\n|\r|\n/g,"<br/>")+"</th>\n";l+="</tr></thead>\n"}for(l+="<tbody>",a=0;a<e.table.length;a++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(u=temHandler(e,csvRedQuery.query,a,a)).toString().left(5)){for(l+="<tr>",n&&(l+="<td>"+(a+1)+"</td>\n"),s=0;s<i.length;s++)u=(o=i[s]-1)>=e.table[a].length?" ":e.table[a][o],!e.statsCnt[o]||"N"!=e.statsCnt[o].fieldType&&"I"!=e.statsCnt[o].fieldType?(""==u&&(u=" "),l+="<td>"+u.toHtml().replace(/\r\n|\n|\r/g,"<br/>")+"</td>\n"):(l+='<td align="right">'+u.toFixed(e.statsCnt[o].fieldDecs)+"</td>\n",c[o]+=1*u);l+="</tr>\n"}if(l+="</tbody>",r){for(l+="<tfoot><tr>",n&&(l+="<th>Sum</th>"),s=0;s<i.length;s++)o=i[s]-1,!e.statsCnt[o]||"N"!=e.statsCnt[o].fieldType&&"I"!=e.statsCnt[o].fieldType?l+="<th>&nbsp;</th>":l+='<th align="right">'+c[o].toFixed(e.statsCnt[o].fieldDecs)+"</th>\n";l+="</tr></tfoot>\n"}return l+="</table></div></div></div>"}function csvToXml(e,t,n){var r,a,o,i=0,l=t||"ROWSET",s=n||"ROW",u='<?xml version="1.0"?>\n<'+l+">\n",c=0,d="",f="";if(o=getFldPosArr(e=e||CSV),0===e.table.length)return u+"</"+l+">";for(a=getCsvHeader(e),i=0;i<e.table.length;i++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(d=temHandler(e,csvRedQuery.query,i,i)).toString().left(5)){for(u+="<"+s+">\n",c=0;c<o.length;c++)d=(r=o[c]-1)>=e.table[i].length?"":e.table[i][r]+"",u+="<"+(f=r>=a.length?"FIELD"+r:a[r]).replace(/\s+/g,"_")+">"+d.toXml()+"</"+f.replace(/\s+/g,"_")+">\n";u+="</"+s+">\n"}return u+="</"+l+">"}function csvToXmlProperties(e,t,n){var r,a,o,i=0,l=t||"ROWSET",s=n||"ROW",u='<?xml version="1.0"?>\n<'+l+">\n",c=0,d="";if(o=getFldPosArr(e=e||CSV),0===e.table.length)return u+"</"+l+">";for(a=getCsvHeader(e),i=0;i<e.table.length;i++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(d=temHandler(e,csvRedQuery.query,i,i)).toString().left(5)){for(u+="<"+s,c=0;c<o.length;c++)d=(r=o[c]-1)>=e.table[i].length?"":e.table[i][r],u+=" "+(r>=a.length?"FIELD"+r:a[r]).replace(/\s+/g,"_")+'="'+(d+"").toXml()+'"';u+="></"+s+">\n"}return u+="</"+l+">"}function csvToJSON(e,t){var n,r,a,o=0,i="[\n",l=0,s="";if(a=getFldPosArr(e=e||CSV),0===e.table.length)return i+"]";for(r=getCsvHeader(e),o=0;o<e.table.length;o++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(s=temHandler(e,csvRedQuery.query,o,o)).toString().left(5)){for(i+="  {\n",l=0;l<a.length;l++)s=(n=a[l]-1)>=e.table[o].length?"":e.table[o][n],i+='    "'+(n>=r.length||!r[n]||""==r[n]?"FIELD"+(l+1):r[n]).toJson()+'":',t||!e.statsCnt[n]||"N"!=e.statsCnt[n].fieldType&&"I"!=e.statsCnt[n].fieldType?i+='"'+s.toJson()+'"':""!=s?("."==(s=s.toNumber()+"").left(1)&&(s="0"+s),"-."==s.left(2)&&(s="-0"+s.substr(1)),i+=s):i+="null",i+=(l<a.length-1?",":"")+"\n";i+="  }",o<e.table.length-1&&(i+=","),i+="\n"}return i+="]"}function csvToJSONArray(e,t){var n,r,a,o=0,i="[\n",l=0,s="";if(a=getFldPosArr(e=e||CSV),0===e.table.length)return i+"]";for(r=getCsvHeader(e),o=0;o<e.table.length;o++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(s=temHandler(e,csvRedQuery.query,o,o)).toString().left(5)){for(1<a.length&&(i+="  ["),l=0;l<a.length;l++)s=(n=a[l]-1)>=e.table[o].length?"":e.table[o][n],n>=r.length?"FIELD"+n:r[n],t||!e.statsCnt[n]||"N"!=e.statsCnt[n].fieldType&&"I"!=e.statsCnt[n].fieldType?i+='"'+s.toJson()+'"':""!=s?("."==(s=s.toNumber()+"").left(1)&&(s="0"+s),"-."==s.left(2)&&(s="-0"+s.substr(1)),i+=s):i+="null",i+=l<a.length-1?",":"";1<a.length&&(i+="  ]"),o<e.table.length-1&&(i+=","),i+="\n"}return i+="]"}function csvToJSONColumnArray(e,t){var n,r,a,o=0,i="{\n",l=0,s="";if(a=getFldPosArr(e=e||CSV),0===e.table.length)return i+"]";for(r=getCsvHeader(e),l=0;l<a.length;l++){n=a[l]-1,i+='    "'+(l>=r.length?"FIELD"+n:r[n])+'":[';var u=0;for(o=0;o<e.table.length;o++)csvRedQuery&&""!=csvRedQuery.query&&"false"==(s=temHandler(e,csvRedQuery.query,o,o)).toString().left(5)||(i+=1<++u?",":"",s=l>=e.table[o].length?"":e.table[o][n],t||!e.statsCnt[n]||"N"!=e.statsCnt[n].fieldType&&"I"!=e.statsCnt[n].fieldType?i+='"'+s.toJson()+'"':""!=s?("."==(s=s.toNumber()+"").left(1)&&(s="0"+s),"-."==s.left(2)&&(s="-0"+s.substr(1)),i+=s):i+="null");i+="]",l<a.length-1&&(i+=","),i+="\n"}return i+="}"}function jsonToCsv(objArray,delimiter,bIncludeHeaders,bQuotes,noMultiLines){var array,str="",line="",i,j,index,value,columns=[];try{array="object"!=typeof objArray?JSON.parse(objArray):objArray}catch(e){array=eval("array="+objArray)}var depth=getJsonLevel(array);if(2==depth&&_.isArray(array)){for(bIncludeHeaders&&(value="Field1",line+=bQuotes?'"'+value.replace(/"/g,'""')+'"'+delimiter:value.toCsv(delimiter,'"'),str+=line+"\n"),i=0;i<array.length;i++){var line="";value=array[i],null==value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(bQuotes?'"':"")+(""+value).toCsv(delimiter,'"')+(bQuotes?'"':""),str+=line+"\n"}return str}if(3==depth&&_.isArray(array)&&_.every(_.values(array),_.isArray)){if(bIncludeHeaders){var head=array[0];for(index in array[0])value="Field"+(1*index+1),columns.push(value),line+=bQuotes?'"'+value.replace(/"/g,'""')+'"'+delimiter:value.toCsv(delimiter,'"')+delimiter;line=line.slice(0,-1),str+=line+"\n"}else for(index in array[0])columns.push(index);for(i=0;i<array.length;i++){var line="";for(j=0;j<columns.length;j++)value=array[i][j],null==value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(bQuotes?'"':"")+(""+value).toCsv(delimiter,'"')+(bQuotes?'"':"")+delimiter;line=line.slice(0,-1*delimiter.length),str+=line+"\n"}return str}for(;_.isObject(array)&&!_.isArray(array)&&1==_.keys(array).length&&(_.isObject(_.values(array)[0])||_.isArray(_.values(array)[0])&&_.isObject(_.values(array)[0][0]));)array=_.values(array)[0];for(0==_.isArray(array)&&1==_.isObject(array)&&(array=JSON.flatten(array),array=JSON.parse("["+JSON.stringify(array)+"]")),i=0;i<array.length;i++)value=array[i][columns[j]],0==_.isArray(value)&&1==_.isObject(value)&&(array[i][columns[j]]=JSON.flatten(value));if(bIncludeHeaders){var head=array[0];if(bQuotes)for(index in array[0])value=index+"",columns.push(value),line+='"'+value.replace(/"/g,'""')+'"'+delimiter;else for(index in array[0])value=index+"",columns.push(value),line+=value.toCsv(delimiter,'"')+delimiter;line=line.slice(0,-1),str+=line+"\n"}else for(index in array[0])columns.push(index);for(i=0;i<array.length;i++){var line="";if(bQuotes)for(j=0;j<columns.length;j++)value=array[i][columns[j]],"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(array[i][columns[j]]).slice(0,-1)),null==value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+='"'+value.replace(/"/g,'""')+'"'+delimiter;else for(j=0;j<columns.length;j++)value=array[i][columns[j]],"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(array[i][columns[j]]).slice(0,-1)),null==value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(""+value).toCsv(delimiter,'"')+delimiter;line=line.slice(0,-1*delimiter.length),str+=line+"\n"}return str}function csvToFixed(e,t,n,r,a,o){var i,l,s=0,u="",c=0,d="",f="",p="";l=getFldPosArr(e);var h=!1,g=!1;if(void 0!==t&&null!=t||(t=" "),!n||""!==t&&" "!==t||(t="|"),0===(e=e||CSV).table.length)return u;var m=getCsvHeader(e),y=getCsvColLength(e),v=0,C="";if(n){for(c=0;c<l.length;c++)i=l[c]-1,e.isFirstRowHeader&&m[i]&&m[i].length>y[i]&&(y[i]=m[i].length),v+=y[i]+1;if(r&&(v+=(""+e.table.length).length+1),u+="+".rpad(v,"-")+"+\n",e.isFirstRowHeader){for(u+=t,r&&(u+="#".rpad((""+e.table.length).length)+t),c=0;c<l.length;c++)0<c&&(u+=t),u+=(d=(i=l[c]-1)>=m.length?"":m[i].replace(/\r\n|\r|\n/g," ")).rpad(y[i]);u+=t+"\n",u+="+".rpad(v,"-")+"+\n"}}var b=0;for(s=0;s<e.table.length;s++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(d=temHandler(e,csvRedQuery.query,s,s)).toString().left(5)){for(b++,n&&(u+=t),r&&(u+=(""+b).rpad((""+e.table.length).length)+t),c=0;c<l.length;c++)0<c&&(u+=t),d=(i=l[c]-1)>=e.table[s].length?"":e.table[s][i],h=g=!1,document.getElementById("ftrim"+(i+1))&&document.getElementById("ftrim"+(i+1)).checked&&(d=d.trim()),document.getElementById("chkupper"+(i+1))&&document.getElementById("chkupper"+(i+1)).checked&&(d=d.toUpperCase()),document.getElementById("chklower"+(i+1))&&document.getElementById("chklower"+(i+1)).checked&&(d=d.toLowerCase()),document.getElementById("chkrjust"+(i+1))&&document.getElementById("chkrjust"+(i+1)).checked&&(g=!0),document.getElementById("chkcjust"+(i+1))&&document.getElementById("chkcjust"+(i+1)).checked&&(h=!0),u+=h?d.replace(/\r\n|\r|\n/g," ").cjust(y[i]):g?d.replace(/\r\n|\r|\n/g," ").rjust(y[i]):d.replace(/\r\n|\r|\n/g," ").rpad(y[i]);var E;if(!n&&a&&1==b){for(E=1;E<=u.length;E++)f+=(""+E).right(1);if(10<=u.length){for(E=1,c=10;c<=u.length;c+=10,E++)p+="         "+(""+E).right(1);f=(p=p.rpad(f.length))+"\n"+f}}n&&(u+=t),u+="\n",n&&o&&(u+="+".rpad(v,"-")+"+\n")}return n&&!o&&(u+="+".rpad(v,"-")+"+\n"),a&&!n&&(C=f.split("\n")[1].replace(/[12346789]/g,"-").replace(/0/g,"|").replace(/5/g,"+"),u=f+"\n"+C+"\n"+u),u}function fixedToCsv(e,t,n,r,a){var o,i,l=t.split("|")||[],s="",u="",c=[],d="",f=e.split(/\n|\r|\r\n/gim);if(""==f[f.length-1]&&f.pop(),r){for(o=0;o<l.length;o++)d=2<(c=l[o].split(",")).length?c[2]:"F"+(o+1),s+=a?'"'+d.replace(/"/g,'""')+'"'+n:d.toCsv(n,'"')+n;s=s.slice(0,-1*n.length)+"\n"}var p=0,h=0;for(o=0;o<f.length;o++)if((u="")!=f[o]){for(i=0;i<l.length;i++)p=0<(c=l[i].split(",")||[]).length?c[0]-1:0,h=1<c.length?c[1]:0,2<c.length?c[2]:"f"+(i+1),value=f[o].substr(p,h).trim(),null==value?value="":value+="",u+=a?'"'+(""+value).replace(/"/g,'""')+'"'+n:(""+value).toCsv(n,'"')+n;s+=(u=u.slice(0,-1*n.length))+"\n"}return s}function csvToMulti(e,t,n,r,a,o){var i,l,s=0,u="",c=0,d="",f="";if(o=o||"0",isNaN("0"+o)&&(o="0"),l=getFldPosArr(e),r=r||"",0===(e=e||CSV).table.length)return u;for(getCsvHeader(e),s=0;s<e.table.length;s++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(d=temHandler(e,csvRedQuery.query,s,s)).toString().left(5)){for(c=0;c<l.length;c++)f="",d=(i=l[c]-1)>=e.table[s].length?"":e.table[s][i].replace(/\r\n|\r|\n/g," "),n&&(f=i>=e.arHeaderRow.length?"".rpad(o)+"Field-"+(i+1)+r:"".rpad(o)+e.arHeaderRow[i].replace(/\r\n|\r|\n/g," ")+r),u+=f+d+"\n",a&&(u+="\n");u+=t+"\n"}return u}function csvToKml(e,t,n,r,a,o){var i,l,s=0,u="",c='<?xml version="1.0" encoding="UTF-8"?>\n';if(c+='<kml xmlns="http://earth.google.com/kml/2.0">\n',c+="<Document>\n",0===(e=e||CSV).table.length)return c+"</Document></kml>";for(l=getCsvHeader(e),(""==o.trim()||isNaN(o)||1*o<1||1*o>e.table[0].length)&&(o=""),s=0;s<e.table.length;s++)if(!csvRedQuery||""==csvRedQuery.query||(v=temHandler(e,csvRedQuery.query,s,s),"false"!=v.toString().left(5))){for(c+="<Placemark>\n",u="",i=0;i<e.table[s].length&&!(i>=l.length);i++)if((isNaN(r)||i!=r-1)&&(isNaN(a)||i!=a-1)){if(isNaN(t)||i!=t-1){if(isNaN(n)||i!=n-1)continue;l[i]="description",""!=o&&(u=" "+e.table[s][o-1])}else l[i]="name";c+="<"+l[i]+">"+e.table[s][i].toHtml()+u.toHtml()+"</"+l[i]+">\n"}!isNaN(r)&&!isNaN(a)&&0<r.length&&0<a.length&&1*r<=e.table[s].length&&1*a<=e.table[s].length&&e.table[s][1*r-1]&&e.table[s][1*a-1]&&(c+="<Point><coordinates>",c+=e.table[s][1*a-1]+","+e.table[s][1*r-1]+",0",c+="</coordinates></Point>\n"),c+="</Placemark>\n"}return c+="</Document>\n</kml>"}function csvToCsv(e,t,n,r,a,o,i){if(0===(e=e||CSV).table.length)return"";var l,s,u,c,d=0,f="",p=0;if(u=getFldPosArr(e),n||a){for(s=getCsvHeader(e),p=0;p<u.length;p++)0<p&&(f+=t),f+=((d=u[p]-1)>=s.length?"":s[d]).toCsv(t,e.quote);""!=f&&(f+="\n")}for(d=0;d<e.table.length;d++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(c=temHandler(e,csvRedQuery.query,d,d)).toString().left(5)){for(p=0;p<u.length;p++)l=u[p]-1,(c=e.table[d][l]?e.table[d][l]:"")&&o&&(c=c.replace(/\r\n|\r|\n/g," ")),r&&""!=c?c.indexOf(",")<0?f+="="+c.toCsv(t,e.quote,e.quote,r):f+='"="'+c.toCsv(t,e.quote,e.quote,r)+'""':i||!e.statsCnt[l]||"N"!=e.statsCnt[l].fieldType&&"I"!=e.statsCnt[l].fieldType?f+=c.toCsv(t,e.quote,e.quote,i):f+=c||"",f+=p<u.length-1?t:"";f+="\n"}return f}function getCsvColLength(e){var t=0,n=0,r=0,a=new Array;if(0===(e=e||CSV).table.length)return a;for(n=0;n<e.maxColumnsFound;n++)a.push(0);for(t=0;t<e.table.length;t++)for(n=0;n<a.length;n++)n>=e.table[t].length||(e.table[t][n].length>a[n]&&(a[n]=e.table[t][n].length),document.getElementById("fpadsize"+(n+1))&&(r=document.getElementById("fpadsize"+(n+1)).value,isNaN(r)?r=0:r*=1,r>a[n]&&(a[n]=r)));return a}function isSqlKeywords(){return["ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","SUM","SYSDATE","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT"]}function csvToSql(e,t,n,r,a,o,i,l,s,u,c,d){var f,p,h,g,m,y=0,v="",C="",b="",E="",S=[],I=[],N=[],R=[],k=[],T="",j=[],A=0;if(0===(e=e||CSV).table.length)return v;for(n=n||"I",r=r||!1,m=getCsvHeader(e),p=f=0;f<m.length;f++)I[f]=m[f].replace(/\s+/g,"_"),j[f]=!1,N[f]=R[f]="",document.getElementById("fkey"+(f+1))&&document.getElementById("fkey"+(f+1)).checked&&(A++,j[f]=!0),document.getElementById("fname"+(f+1))&&(I[f]=document.getElementById("fname"+(f+1)).value.replace(/\s+/g,"_")),document.getElementById("freq"+(f+1))&&(k[f]=document.getElementById("freq"+(f+1)).checked),document.getElementById("fsize"+(f+1))?(N[f]=document.getElementById("fsize"+(f+1)).value.trim(),isNaN(N[f])?N[f]=30:N[f]*=1,N[f]<1&&(N[f]="")):N[f]=30,document.getElementById("fdec"+(f+1))&&(R[f]=document.getElementById("fdec"+(f+1)).value.trim(),isNaN(R[f])?R[f]="":(R[f]*=1,R[f]<0&&(R[f]=""))),document.getElementById("finc"+(f+1))?document.getElementById("finc"+(f+1)).checked?(S[f]=!0,p++):S[f]=!1:(S[f]=!0,p++);if(0==p)return"";if(0<t.indexOf(" ")&&(t='"'+t+'"'),i&&(v+="DROP TABLE "+(l?"IF EXISTS ":"")+t+";\n"),a){var B=r;for(v+="CREATE TABLE "+(o?"IF NOT EXISTS ":"")+t+"(",(r=!0)&&(v+="\n"),p=f=0;f<m.length;f++,p++){switch(r&&0<p&&(v+="\n"),v+=0<p?",":" ",v+=" "+I[f],C=e.statsCnt[f].fieldType,document.getElementById("ftype"+(f+1))&&(C=document.getElementById("ftype"+(f+1)).value),C){case"B":v+=" BIT ";break;case"NR":case"N":v+="N"==C?" NUMERIC":" NUMBER",h=e.statsCnt[f].fieldPrec+e.statsCnt[f].fieldDecs,g=e.statsCnt[f].fieldDecs,N[f]&&N[f]>h&&(h=N[f]),v+=""!=h?"("+h+","+g+")":" ";break;case"IT":v+=" INT ";break;case"I":v+=" INTEGER",v+=""!=(h=N[f])?"("+h+")":" ";break;case"S":v+=" SERIAL ";break;case"D":v+=" DATE ";break;case"DT":v+=" DATETIME ";break;case"VC":v+=" VARCHAR("+N[f]+")";break;default:v+=" CHAR("+N[f]+")"}k[f]&&(v+=" NOT NULL"),j[f]&&1==A&&(v+=" PRIMARY KEY","N"!=C&&"NR"!=C&&"I"!=C&&"IT"!=C||document.getElementById("selAutoIncrement")&&(v+=" "+document.getElementById("selAutoIncrement").value))}if(1<A){for(r&&(v+="\n"),v+=", PRIMARY KEY(",x=0;x<j.length;x++)j[x]&&(v+=(0<x?",":"")+I[x]);v+=")"}r&&(v+="\n"),v+=");\n",r=B}switch(n){case"I":for(y=0;y<e.table.length;y++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(b=temHandler(e,csvRedQuery.query,y,y)).toString().left(5)){if(0!=y&&c)v+=",(";else{for(v+=s?"REPLACE":"INSERT",""!=u.trim()&&(v+=" "+u.trim()),v+=" INTO "+t+"(",r&&(v+="\n"),p=f=0;f<m.length;f++)S[f]&&(0<p&&(v+=","),v+=I[f],r&&(v+="\n"),p++);v+=") VALUES"+(c?"\n":"")+" ("}for(r&&(v+="\n"),p=f=0;f<m.length;f++)if(S[f]){if(C=e.statsCnt[f].fieldType,b=f>=e.table[y].length?"":e.table[y][f],document.getElementById("ftype"+(f+1))&&(C=document.getElementById("ftype"+(f+1)).value),document.getElementById("ftem"+(f+1))&&(E=document.getElementById("ftem"+(f+1)).value),document.getElementById("ftrim"+(f+1))&&document.getElementById("ftrim"+(f+1)).checked&&(b=b.trim()),document.getElementById("chkupper"+(f+1))&&document.getElementById("chkupper"+(f+1)).checked&&(b=b.toUpperCase()),document.getElementById("chklower"+(f+1))&&document.getElementById("chklower"+(f+1)).checked&&(b=b.toLowerCase()),0<p&&(v+=","),""!=E)v+="N"==C||"NR"==C||"I"==C||"IT"==C||"S"==C||"D"==C||"DT"==C?""==b?E.replace("{f}","NULL"):"D"==C||"DT"==C?E.replace("{f}","'"+b.toSql()+"'"):E.replace("{f}",b.toSql()):E.replace("{f}","'"+b.toSql()+"'");else switch(C){case"B":case"NR":case"S":case"N":case"IT":case"I":""===b.trim()||"NULL"==b.toUpperCase()&&d?v+="NULL":v+=b.toSql();break;case"DT":case"D":""===b||"NULL"==b.toUpperCase()&&d?v+="NULL":v+="'"+b.toSql()+"'";break;default:"NULL"==b.toUpperCase()&&d?v+="NULL":v+="'"+b.toSql()+"'"}r&&(v+="\n"),p++}c&&y!=e.table.length-1?v+=")\n":v+=");\n"}break;case"U":for(y=0;y<e.table.length;y++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(b=temHandler(e,csvRedQuery.query,y,y)).toString().left(5)){for(T="1=1",v+="UPDATE",""!=u.trim()&&(v+=" "+u.trim()),v+=" "+t+" SET ",r&&(v+="\n"),f=0;f<m.length;f++)j[f]&&(T+=" AND "+I[f]+"= {f"+f+"}");for("1=1"===T&&(T+=" AND "+I[0]+"= {f0}"),p=f=0;f<m.length;f++){switch(S[f]&&(0<p&&(v+=","),v+=I[f]+" = ",p++),C=e.statsCnt[f].fieldType,b=f>=e.table[y].length?"":e.table[y][f],document.getElementById("ftype"+(f+1))&&(C=document.getElementById("ftype"+(f+1)).value),document.getElementById("ftem"+(f+1))&&(E=document.getElementById("ftem"+(f+1)).value),document.getElementById("ftrim"+(f+1))&&document.getElementById("ftrim"+(f+1)).checked&&(b=b.trim()),document.getElementById("chkupper"+(f+1))&&document.getElementById("chkupper"+(f+1)).checked&&(b=b.toUpperCase()),document.getElementById("chklower"+(f+1))&&document.getElementById("chklower"+(f+1)).checked&&(b=b.toLowerCase()),""!=E&&(v+=""!=b||"N"!=C&&"NR"!=C&&"I"!=C&&"IT"!=C&&"D"!=C?E.replace("{f}",b.toSql()):E.replace("{f}","NULL")),C){case"B":S[f]&&(v+="'"+b.toSql()+"'"),T=T.replace("{f"+f+"}","'"+b.toSql()+"'");break;case"NR":case"N":S[f]&&(""===b||"NULL"==b.toUpperCase()&&d?v+="NULL":v+=b.toSql()),T=T.replace("{f"+f+"}",b.toSql());break;case"IT":case"I":S[f]&&(""===b||"NULL"==b.toUpperCase()&&d?v+="NULL":v+=b.toSql()),T=T.replace("{f"+f+"}",b.toSql());break;case"D":S[f]&&(v+=""===b||"NULL"==b&&d?"NULL":"'"+b.toSql()+"'"),T=T.replace("{f"+f+"}","'"+b.toSql()+"'");break;default:S[f]&&("NULL"==b.toUpperCase()&&d?v+="NULL":v+="'"+b.toSql()+"'"),T=T.replace("{f"+f+"}","'"+b.toSql()+"'")}S[f]&&(r&&(v+="\n"),p++)}v+=" WHERE "+T,v+=";\n"}break;case"D":for(y=0;y<e.table.length;y++)if(!csvRedQuery||""==csvRedQuery.query||"false"!=(b=temHandler(e,csvRedQuery.query,y,y)).toString().left(5)){for(T="1=1",v+="DELETE FROM "+t,r&&(v+="\n"),f=0;f<I.length;f++)j[f]&&(T+=" AND "+I[f]+"= {f"+f+"}");for("1=1"===T&&(T+=" AND "+I[0]+"= {f0}"),p=f=0;f<m.length;f++){switch(p++,C=e.statsCnt[f].fieldType,b=f>=e.table[y].length?"":e.table[y][f],document.getElementById("ftype"+(f+1))&&(C=document.getElementById("ftype"+(f+1)).value),document.getElementById("ftem"+(f+1))&&(E=document.getElementById("ftem"+(f+1)).value),document.getElementById("ftrim"+(f+1))&&document.getElementById("ftrim"+(f+1)).checked&&(b=b.trim()),document.getElementById("chkupper"+(f+1))&&document.getElementById("chkupper"+(f+1)).checked&&(b=b.toUpperCase()),document.getElementById("chklower"+(f+1))&&document.getElementById("chklower"+(f+1)).checked&&(b=b.toLowerCase()),C){case"B":case"NR":case"N":case"IT":case"S":case"I":T=T.replace("{f"+f+"}",b.toSql());break;default:T=T.replace("{f"+f+"}","'"+b.toSql()+"'")}r&&(v+="\n"),p++}v+=" WHERE "+T,v+=";\n"}}return v}function geoJsonToCsv(geo,delimiter,bIncludeHeaders,bQuotes,noMultiLines){var j,s="",value="",cols={},obj={};if("string"==typeof geo)try{geo=JSON.parse(geo)}catch(e){geo=eval("geo="+geo)}var colnum=0;if("Feature"===geo.type&&(geo={type:"FeatureCollection",features:[geo]}),"FeatureCollection"===geo.type){for(j=0;j<geo.features.length;j++)for(p in"Point"===geo.features[j].geometry.type?("latitude"in cols||(cols.latitude=++colnum),"longitude"in cols||(cols.longitude=++colnum)):cols.coordinates=++colnum,geo.features[j].properties)p in cols||(cols[p]=++colnum);for(j=0;j<geo.features.length;j++){for(p in"latitude"in cols&&("Point"===geo.features[j].geometry.type?(s+=(bQuotes?'"':"")+geo.features[j].geometry.coordinates[1]+(bQuotes?'"':"")+delimiter,s+=(bQuotes?'"':"")+geo.features[j].geometry.coordinates[0]+(bQuotes?'"':"")+delimiter):(s+=(bQuotes?'""':"")+delimiter,s+=(bQuotes?'""':"")+delimiter)),"coordinates"in cols&&("Point"!=geo.features[j].geometry.type?(value=geo.features[j].geometry.coordinates,"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(value).slice(0,-1)),s+=(""+value).toCsv(delimiter,'"','"',bQuotes)+delimiter):s+=(bQuotes?'""':"")+delimiter),cols)"latitude"!=p&&"longitude"!==p&&"coordinates"!==p&&(p in geo.features[j].properties?(value=geo.features[j].properties[p],null==value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),s+=value.toCsv(delimiter,'"','"',bQuotes)+delimiter):s+=(bQuotes?'""':"")+delimiter);s=s.slice(0,-1*delimiter.length)+"\n"}}var t="";if(bIncludeHeaders){for(p in"latitude"in cols&&(t+="latitude".toCsv(delimiter,'"','"',bQuotes)+delimiter),"longitude"in cols&&(t+="longitude".toCsv(delimiter,'"','"',bQuotes)+delimiter),"coordinates"in cols&&(t+="coordinates".toCsv(delimiter,'"','"',bQuotes)+delimiter),cols)"latitude"!=p&&"longitude"!==p&&"coordinates"!==p&&(t+=p.toCsv(delimiter,'"','"',bQuotes)+delimiter);t=t.slice(0,-1*delimiter.length)+"\n"}return t+s}function htmlEscape(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getCsvHeader(e){var t,n=new Array;(e=e||CSV)||alert("Missing oCsv"),e.arHeaderRow||alert("Missing arHeaderRow");var r=e.arHeaderRow.length;for(r<e.maxColumnsFound&&(r=e.maxColumnsFound),t=0;t<r;t++)e.arHeaderRow[t]||e.arHeaderRow.push("FIELD"+(t+1)),n.push(e.arHeaderRow[t]),e.headerToUpper?(e.arHeaderRow[t]=e.arHeaderRow[t].toUpperCase(),n[n.length-1]=n[n.length-1].toUpperCase()):e.headerToLower&&(e.arHeaderRow[t]=e.arHeaderRow[t].toLowerCase(),n[n.length-1]=n[n.length-1].toLowerCase());return n}function sqlOptions(e){var t=getCsvColLength(e=e||CSV),n=getCsvHeader(e),r="<table>\n<tr>\n<th>Col #</th><th>Field Name</th><th>Data Type</th><th>Max Size</th><th title='# of decimals'>#<br/>Dec</th>";r+='<th>Key</th><th>Include</th><th>Required</th><th>Trim</th><th>Upper</th><th>Lower</th><th title="Modify output by using {f} for field value. Ex: {f}+100">Template ({f}=field)<br/>Ex: {f}+100</th></tr>';var a,o="<tr><td>{#}</td>";for(o+='<td><input type=text id="fname{#}" size="15" value="{FIELDNAME{#}}"></td>\n',o+='<td><select id="ftype{#}" title="Choose data type of column" >',o+='<option value="VC" {VC{#}}>VarChar</option>',o+='<option value="C" {C{#}}>Char</option>',o+='<option value="NR" {NR{#}}>Number</option>',o+='<option value="N" {N{#}}>Numeric</option>',o+='<option value="IT" {IT{#}}>Int</option>',o+='<option value="I" {I{#}}>Integer</option>',o+='<option value="D" {D{#}}>Date</option>',o+='<option value="DT" {DT{#}}>Date Time</option>',o+='<option value="B" {B{#}}>Bit(0,1)</option>',o+='<option value="S" {S{#}}>Serial</option>',o+='</select>\n</td><td><input id="fsize{#}"size=4 maxlength=4 value="{FIELDSIZE{#}}"></td>\n',o+='<td><input id="fdec{#}"size=2 maxlength=2 value="{DECSIZE{#}}" readonly></td>',o+='<td><input type=checkbox id="fkey{#}"  value="Y" ></td>\n',o+='<td><input type=checkbox id="finc{#}"  value="Y" checked></td>\n',o+='<td><input type=checkbox id="freq{#}"  value="Y" ></td>\n',o+='<td><input type=checkbox id="ftrim{#}" value="Y" checked></td>\n',o+='<td><input type=checkbox id="chkupper{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chklower{#}\').checked=false"></td>\n',o+='<td><input type=checkbox id="chklower{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkupper{#}\').checked=false"></td>\n',o+='<td><input type="text" id="ftem{#}" value="" size="15" maxlength="200"></td>',o+="</tr>",a=0;a<n.length;a++)r+=o.replace(/{#}/g,""+(a+1)).replace("{FIELDNAME"+(a+1)+"}",n[a].replace(/[@+<>"'?\.,-\/#!$%\^&\*;:{}=\-`~()\[\]\\\|]/g,"").replace(/\s+/g,"_").replace(/_+/g,"_")).replace("{FIELDSIZE"+(a+1)+"}",0==t[a]?1:t[a]),r=(r="N"===e.statsCnt[a].fieldType?r.replace("{DECSIZE"+(a+1)+"}",e.statsCnt[a].fieldDecs):r.replace("{DECSIZE"+(a+1)+"}","")).replace("ftitle"+(a+1)+"}","Type:"+e.statsCnt[a].fieldType+",Counts: Total: "+e.table.length+",Int: "+e.statsCnt[a].intCnt+" ,Numeric:"+e.statsCnt[a].realCnt+",Bit:"+e.statsCnt[a].bitCnt+",Date:"+e.statsCnt[a].dateCnt+",Empty:"+e.statsCnt[a].emptyCnt),"VC"===e.statsCnt[a].fieldType&&(r=r.replace("{VC"+(a+1)+"}","selected")),"C"===e.statsCnt[a].fieldType&&(r=r.replace("{C"+(a+1)+"}","selected")),"N"===e.statsCnt[a].fieldType&&(r=r.replace("{N"+(a+1)+"}","selected")),"I"===e.statsCnt[a].fieldType&&(r=r.replace("{I"+(a+1)+"}","selected")),"B"===e.statsCnt[a].fieldType&&(r=r.replace("{B"+(a+1)+"}","selected")),"D"===e.statsCnt[a].fieldType&&(r=r.replace("{D"+(a+1)+"}","selected")),"S"===e.statsCnt[a].fieldType&&(r=r.replace("{S"+(a+1)+"}","selected"));return r+="</table>"}function setOptions(e){var t,n=getCsvHeader(e=e||CSV);for(document.getElementById("fkey1")&&(document.getElementById("fkey1").checked=!0),document.getElementById("freq1")&&(document.getElementById("freq1").checked=!0),t=0;t<n.length;t++)document.getElementById("fname"+(t+1))&&(document.getElementById("fname"+(t+1)).value=n[t].replace(/[@+<>"'?\.,-\/#!$%\^&\*;:{}=\-`~()\[\]\\\|]/g,"").replace(/\s+/g,"_").replace(/_+/g,"_"),document.getElementById("ftype"+(t+1))&&(e.statsCnt[t]||(document.getElementById("ftype"+(t+1)).value=e.statsCnt[t].fieldType,document.getElementById("ftype"+(t+1)).title="Type:"+e.statsCnt[t].fieldType+",Counts: Total: "+e.table.length+",Int: "+e.statsCnt[t].intCnt+" ,Numeric:"+e.statsCnt[t].realCnt+",Bit:"+e.statsCnt[t].bitCnt+",Date:"+e.statsCnt[t].dateCnt+",Empty:"+e.statsCnt[t].emptyCnt)))}function flatOptions(e){getCsvColLength(e=e||CSV);var t=getCsvHeader(e),n="<table>\n<tr>\n<th>Col #</th><th>Field Name</th><th>Trim</th><th>Pad Size</th>";n+="<th>Upper</th><th>Lower</th><th>Right<br/>Justify</th><th>Center<br/>Justify</th></tr>";var r,a="<tr><td>{#}</td>";for(a+="<td>{FIELDNAME{#}}</td>\n",a+='<td><input type=checkbox id="ftrim{#}" value="Y" ></td>\n',a+='<td><input type=text id="fpadsize{#}" size=3 maxlength=3 value="" ></td>\n',a+='<td><input type=checkbox id="chkupper{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chklower{#}\').checked=false"></td>\n',a+='<td><input type=checkbox id="chklower{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkupper{#}\').checked=false"></td>\n',a+='<td><input type=checkbox id="chkrjust{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkcjust{#}\').checked=false"></td>\n',a+='<td><input type=checkbox id="chkcjust{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkrjust{#}\').checked=false"></td>\n',a+="</tr>",r=0;r<t.length;r++)n+=a.replace(/{#}/g,""+(r+1)).replace("{FIELDNAME"+(r+1)+"}",t[r].replace(/\s+/g,"_"));return n+="</table>"}function parseAndOptions(e,t){e=e||CSV,document.getElementById("txtRowLimit")&&(e.limit=document.getElementById("txtRowLimit").value),document.getElementById("chkHeader")&&(e.isFirstRowHeader=document.getElementById("chkHeader").checked),document.getElementById("chkHeaderUpper")&&(e.headerToUpper=document.getElementById("chkHeaderUpper").checked),document.getElementById("chkHeaderLower")&&(e.headerToLower=document.getElementById("chkHeaderLower").checked),document.getElementById("txt1")&&CSV.parse(document.getElementById("txt1").value),document.getElementById("divOptions")&&(CSV.prevColumnsFound!=CSV.maxColumnsFound||t)&&(document.getElementById("divOptions").innerHTML=sqlOptions(CSV),setOptions(e),CSV.prevColumnsFound=CSV.maxColumnsFound),document.getElementById("divFlatOptions")&&(CSV.prevColumnsFound!=CSV.maxColumnsFound||t)&&(document.getElementById("divFlatOptions").innerHTML=flatOptions(CSV),CSV.prevColumnsFound=CSV.maxColumnsFound),document.getElementById("divInputCounts")&&(document.getElementById("divInputCounts").innerHTML="Input Records- Header: "+(0==CSV.arHeaderRow.length&&CSV.isFirstRowHeader?"missing":CSV.isFirstRowHeader)+" &nbsp; &nbsp;  Separator: "+("\t"==CSV.delimiter?"Tab":" "==CSV.delimiter?"Space":CSV.delimiter)+" &nbsp; &nbsp;  Fields: "+CSV.maxColumnsFound+" &nbsp; &nbsp;  Data Records: "+(CSV.dataRowsFound<=0?"0":CSV.dataRowsFound))}function clearAll(){var e=!1;document.getElementById("chkAppend")&&(e=document.getElementById("chkAppend").checked),document.getElementById("sepAuto")&&(document.getElementById("sepAuto").checked=!0),CSV&&(CSV.delimiter=",",CSV.autodetect=!0),document.getElementById("txt1")&&(document.getElementById("txt1").value=""),e||document.getElementById("txta")&&(document.getElementById("txta").value=""),document.getElementById("txtCols")&&(document.getElementById("txtCols").value=""),document.getElementById("chkHeader")&&(document.getElementById("chkHeader").checked=!0),document.getElementById("chkHeaderUpper")&&(document.getElementById("chkHeaderUpper").checked=!1),document.getElementById("chkHeaderLower")&&(document.getElementById("chkHeaderLower").checked=!1),e||document.getElementById("diva")&&(document.getElementById("diva").innerHTML=""),document.getElementById("divOptions")&&(document.getElementById("divOptions").innerHTML=""),document.getElementById("divFlatOptions")&&(document.getElementById("divFlatOptions").innerHTML=""),parseAndOptions(),setupSortDD()}function getUserOptions(e){}function radiovalue(e){if(!e)return"";var t=e.length;if(null==t)return e.checked?e.value:"";for(var n=0;n<t;n++)if(e[n].checked)return e[n].value;return""}function setRadioValue(e,t){if(e){var n=e.length;if(null!=n){"\t"===(t=(t||"")+"")&&(t="\\t");for(var r=0;r<n;r++)e[r].checked=!1,e[r].value==t&&(e[r].checked=!0)}else e.checked=e.value==t.toString()}}function sortStr(){var e,t,n;for(n="",t=1;t<=4;t++)document.getElementById("selSortFld"+t)&&""!=(e=document.getElementById("selSortFld"+t).value)&&(1<t&&(n+=","),n+=document.getElementById("selSortType"+t).value+e+document.getElementById("selSortAsc"+t).value);return CSV.setSortFlds(n),CSV.mySortNeeded=!0,n}function setupSortDD(){var e,t,n,r;for(t=1;t<=4;t++)if(e=document.getElementById("selSortFld"+t)){if(e.options.length-1==CSV.maxColumnsFound)break;for(e.options.length=1,e.selectedIndex=0,n=1;n<=CSV.maxColumnsFound;n++)(r=document.createElement("option")).text=r.value=""+n,e.options.add(r)}sortStr(),typeof csvCreateQueryUI==typeof Function&&csvCreateQueryUI(),document.getElementById("btnColsReset")&&document.getElementById("btnColsReset").click(),csvRedQuery&&(csvRedQuery.query="")}function getFldPosArr(e){var t,n=[];if(""!=(e=e||CSV).displayPoss)for(t=(n=e.displayPoss.split(",")).length-1;0<=t;t--)(isNaN(n[t])||n[t]<1||n[t]>e.maxColumnsFound)&&n.splice(t,1);if(0==n.length)for(t=0;t<e.maxColumnsFound;t++)n[n.length]=t+1;if(0==n.length)for(t=0;t<e.arHeaderRow.length;t++)n[n.length]=t+1;return n}function flattenSqlJson(e){var t,n=[];for(t=0;t<e.length;t++){var r={};for(k=0;k<e[t].length;k++)r[e[t][k].column]=e[t][k].value;n[t]=r}return n}function getExampleCsv(){return'id,name,amount,Remark\n1,"Johnson, Smith, and Jones Co.",345.33,Pays on time\n2,"Sam ""Mad Dog"" Smith",993.44,\n3,"Barney & Company",0,"Great to work with\nand always pays with cash."\n4,Johnson\'s Automotive,2344,\n'}function getExampleXml(e){e=(e||1)-1;return'<?xml version="1.0"?>\n<ROWSET>\n<ROW>\n<id>1</id>\n<name>Johnson, Smith, and Jones Co.</name>\n<amount>345.33</amount>\n<Remark>Pays on time</Remark>\n</ROW>\n<ROW>\n<id>2</id>\n<name>Sam &quot;Mad Dog&quot; Smith</name>\n<amount>993.44</amount>\n<Remark></Remark>\n</ROW>\n<ROW>\n<id>3</id>\n<name>Barney &amp; Company</name>\n<amount>0</amount>\n<Remark>Great to work with\nand always pays with cash.</Remark>\n</ROW>\n<ROW>\n<id>4</id>\n<name>Johnson&apos;s Automotive</name>\n<amount>2344</amount>\n<Remark></Remark>\n</ROW>\n</ROWSET>'}function getExampleJson(e){return['[\n  {\n    "id":1,    "name":"Johnson, Smith, and Jones Co.",\n    "amount":345.33,    "Remark":"Pays on time"\n  },\n  {\n    "id":2,    "name":"Sam \\"Mad Dog\\" Smith",\n    "amount":993.44,    "Remark":""\n  },\n  {\n    "id":3,    "name":"Barney & Company",\n    "amount":0,    "Remark":"Great to work with\\nand always pays with cash."\n  },\n  {\n    "id":4,    "name":"Johnson\'s Automotive",\n    "amount":2344,    "Remark":""\n  }\n]\n','{ "data" : [\n  {    "id":1,    "name":"Johnson, Smith, and Jones Co."  },\n  {    "id":2,    "name":"Sam \\"Mad Dog\\" Smith"  },\n  {    "id":3,    "name":"Barney & Company"  },\n  {    "id":4,    "name":"Johnson\'s Automotive"  }\n] }\n','{ "race" : \n { "entries" : [\n  {    "id":11,    "name":"Johnson, Smith, and Jones Co."  },\n  {    "id":22,    "name":"Sam \\"Mad Dog\\" Smith"  },\n  {    "id":33,    "name":"Barney & Company"  },\n  {    "id":44,    "name":"Johnson\'s Automotive"  }\n] }\n}\n','{\n    "id":1,    "name":"Johnson, Smith, and Jones Co.",    "amount":345.33,    "Remark":"Pays on time"\n}\n','[\n    [      1,      "Johnson, Smith, and Jones Co.",      345.33    ],\n    [      99,      "Acme Food Inc.",      2993.55    ]\n]'][e=(e||1)-1]}function getExampleKml(){return'National Park,$ Obligated,State,Latitude,Longitude\nAbraham Lincoln Birthplace NHS,"$34,584",KY,37.6116333423,-85.6442940021\nAcadia,"$102,631",ME,44.3593807753,-68.2397319808\nAndersonville,"$65,133",GA,32.197905290823,-84.1302615685733\nAndrew Johnson ,"$17,949",TN,36.1562449930463,-82.8370902853041\nAntietam,"$54,743",MD,39.462381614,-77.7359854016\nAppomattox Court House,"$12,651",VA,37.3826448073,-78.8027430409\nAssateague Island,"$51,921",MD,38.0556022623662,-75.2453836072023\nBig Bend,"$535,983",TX,29.0103562389,-103.311115521\nBig South Fork National River and Recreation Area,"$3,009","TN, KY",36.3837375235,-84.6743069824\n'}function getExampleFlat(){return'1     Johnson, Smith, and Jones Co.  345.33     Pays on time                  \n2     Sam "Mad Dog" Smith            993.44              \n3     Barney & Company               0          Great to work with and always pays with cash.      \n4     Johnson\'s Automotive           2344        \n'}function getExampleGeoJson(e){return'{"type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"Point","coordinates":[-85.6442940021,37.6116333423]},"properties":{"National Park":"Abraham Lincoln Birthplace NHS","$ Obligated":"$34,584","State":"KY"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-68.2397319808,44.3593807753]},"properties":{"National Park":"Acadia","$ Obligated":"$102,631","State":"ME"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-84.1302615685733,32.197905290823]},"properties":{"National Park":"Andersonville","$ Obligated":"$65,133","State":"GA"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-82.8370902853041,36.1562449930463]},"properties":{"National Park":"Andrew Johnson ","$ Obligated":"$17,949","State":"TN"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-77.7359854016,39.462381614]},"properties":{"National Park":"Antietam","$ Obligated":"$54,743","State":"MD"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-78.8027430409,37.3826448073]},"properties":{"National Park":"Appomattox Court House","$ Obligated":"$12,651","State":"VA"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-75.2453836072023,38.0556022623662]},"properties":{"National Park":"Assateague Island","$ Obligated":"$51,921","State":"MD"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-103.311115521,29.0103562389]},"properties":{"National Park":"Big Bend","$ Obligated":"$535,983","State":"TX"}},{"type":"Feature","geometry":{"type":"Point","coordinates":[-84.6743069824,36.3837375235]},"properties":{"National Park":"Big South Fork National River and Recreation Area","$ Obligated":"$3,009","State":"TN, KY"}}]}'}function loadScript(e){var t=document.createElement("script");t.type="text/javascript",t.id="dynScriptTemp",t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}function loadScriptAndRun(e){e.startsWith("?")||(e="?"+e),loadScript("http://www.ddginc-usa.com/cgi-bin/url-to-json.php"+e)}function loadDataAndRun(e){document.getElementById("txt1").value=e.html.join("\n"),document.getElementById("btnRun").click()}function loadURL(e){if(""==e.trim())return alert("Missing URL"),!1;loadScriptAndRun("?callback=loadDataAndRun&url="+encodeURIComponent(e))}function prettyJSON(e,t){t=t||3;if("undefined"==typeof JSON)return e;try{if("string"==typeof e)return JSON.stringify(JSON.parse(e),null,t);if("object"==typeof e)return JSON.stringify(e,null,t)}catch(e){}return e}function getJsonLevel(e){"string"==typeof e&&(e=JSON.parse(e));var t,n,r=JSON.stringify(e,null,"\t").split(/\r\n|\n|\r/gm),a=0;for(t=0;t<r.length;t++)"\t"==r[t].charAt(0)&&(n=r[t].match(/\t+/gm))[0].length>a&&(a=n[0].length);return a+1}function saveOutput(e,t,n){var r=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(r,t)}function saveFile(e,t){var n=document.getElementById("fn").value.trim();""==n&&(n=document.getElementById("fn").value="convertcsv"),saveOutput(e.replace(/\r\n|\r|\n/gm,"\r\n"),n+"."+t,null)}function loadCsv(){storageSup.has_html5_storage()&&(document.getElementById("txt1")&&"Y"!=sessionStorage.getItem("clearPressed")&&(document.getElementById("chkHeader")&&(document.getElementById("chkHeader").checked="Y"==localStorage.getItem("csvChkHeader"),setRadioValue(document.forms.frm1.sep,localStorage.getItem("csvDelimiter"))),assignText(storageSup.getCsv())),sessionStorage.setItem("clearPressed",""))}function saveCsv(){storageSup.has_html5_storage()&&document.getElementById("txt1")&&document.getElementById("txt1").value!=getExampleCsv()&&0<document.getElementById("txt1").value.length&&storageSup.putCsv(document.getElementById("txt1").value,document.getElementById("chkHeader").checked?"Y":"N",radiovalue(document.forms.frm1.sep))}function clearPage(){storageSup.has_html5_storage()&&sessionStorage.setItem("clearPressed","Y"),window.location.reload(!0)}"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,a,o,i,l=gap,s=t[e];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(e)),"function"==typeof rep&&(s=rep.call(t,e,s)),typeof s){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(s)){for(o=s.length,n=0;n<o;n+=1)i[n]=str(n,s)||"null";return a=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+l+"]":"["+i.join(",")+"]",gap=l,a}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;n<o;n+=1)"string"==typeof rep[n]&&(a=str(r=rep[n],s))&&i.push(quote(r)+(gap?": ":":")+a);else for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(a=str(r,s))&&i.push(quote(r)+(gap?": ":":")+a);return a=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+l+"}":"{"+i.join(",")+"}",gap=l,a}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(indent=gap="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if((rep=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,a=e[t];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(void 0!==(r=walk(a,n))?a[n]=r:delete a[n]);return reviver.call(e,t,a)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),JSON.unflatten=function(e){"use strict";if(Object(e)!==e||Array.isArray(e))return e;var t,n,r,a,o,i={};for(var l in e){for(t=i,n="",a=0;r=l.indexOf(".",a),o=l.substring(a,-1!==r?r:void 0),t=t[n]||(t[n]=isNaN(parseInt(o))?{}:[]),n=o,a=r+1,0<=r;);t[n]=e[l]}return i[""]},JSON.flatten=function(e){var l={};return function e(t,n){if(Object(t)!==t)l[n]=t;else if(Array.isArray(t)){for(var r=0,a=t.length;r<a;r++)e(t[r],n?n+"."+r:""+r);0==a&&(l[n]=[])}else{var o=!0;for(var i in t)o=!1,e(t[i],n?n+"."+i:i);o&&(l[n]={})}}(e,""),l},JSON.valueArray=function(e){var l="";return function e(t,n){if(Object(t)!==t)l+=t+"|";else if(Array.isArray(t)){for(var r=0,a=t.length;r<a;r++)e(t[r],n?n+"."+r:""+r);0==a&&(l+="|")}else{var o=!0;for(var i in t)o=!1,e(t[i],n?n+"."+i:i);o&&(l+="|")}}(e,""),l},String.prototype.lpad=function(e,t){if(void 0===t)t=" ";for(var n=this;n.length<e;)n=t+n;return n},String.prototype.zeroPad=function(e){var t=this,n=!1;return isNaN(t)?t:t.length>e?t.toString():(t<0&&(n=!0),n?"0"==(t=t.substring(1).lpad(e,"0")).charAt(0)&&(t="-"+t.substring(1)):t=t.lpad(e,"0"),t)},String.prototype.rpad=function(e,t){if(void 0===t)t=" ";for(var n=this;n.length<e;)n+=t;return n},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/g,"")},"function"!=typeof String.prototype.repeat&&(String.prototype.repeat=function(e){return e=e||1,Array(e+1).join(this)}),String.prototype.ljust=function(e,t){return t=(t=t||" ").substr(0,1),this.length<e?this+t.repeat(e-this.length):this},String.prototype.rjust=function(e,t){return t=(t=t||" ").substr(0,1),this.length<e?t.repeat(e-this.length)+this:this},String.prototype.cjust=function(e,t){if(t=(t=t||" ").substr(0,1),this.length<e-1){var n=e-this.length,r=n%2==0?"":t,a=t.repeat(Math.floor(n/2));return a+this+a+r}return this.rpad(e)},"function"!=typeof String.prototype.left&&(String.prototype.left=function(e){return this.substring(0,e)}),"function"!=typeof String.prototype.right&&(String.prototype.right=function(e){return this.substring(this.length-e)}),String.prototype.removePunctuation=function(){return this.replace(/[@+<>"'?\.,-\/#!$%\^&\*;:{}=\-_`~()\[\]\\\|]/g,"")},"function"!=typeof String.prototype.enclose&&(String.prototype.enclose=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=""),""!=t){var n=new RegExp(e.regExpEscape(e),"gmi");return e+this.replace(n,t+e)+e}return e+this+e}),String.prototype.toHtml=function(){return this.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},String.prototype.toXml=function(){return this.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},String.prototype.toCsv=function(e,t,n,r){void 0===e&&(e=","),void 0===t&&(t='"'),void 0===n&&(n=t),void 0===r&&(r=!1);var a=0<=this.indexOf(t)||0<=this.indexOf(e)||0<=this.indexOf("\r")||0<=this.indexOf("\n");return r&&(a=!0),a?this.enclose(t,n):this},"function"!=typeof String.prototype.isNumeric&&(String.prototype.isNumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)}),String.prototype.toNumber=function(){var e=this.replace(/[^\d.\-\+eE]/g,"");return 0<e.length&&!isNaN(e)&&(e*=1),e},String.prototype.toInteger=function(){return parseInt(this.toNumber().toString(),10)},String.prototype.toFixed=function(e){var t=this.toNumber().toString();return 0<t.length&&!isNaN(t)&&(t=(1*t).toFixed(e)),String(t)},String.prototype.toDollar=function(e,t){var n=this.toNumber().toString();if(void 0===e&&(e=2),void 0===t&&(t="$"),0<n.length&&!isNaN(n)){var r,a,o;a=(r=(1*n).toFixed(e).split("."))[0],o=1<r.length?"."+r[1]:"";for(var i=/(\d+)(\d{3})/;i.test(a);)a=a.replace(i,"$1,$2");n=t+a+o}return String(n)},String.prototype.toJson=function(){return this.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")},String.prototype.toSql=function(){return this.replace(/'/g,"''")},String.prototype.toYaml=function(){return/[\r\n\f\v\t]/g.test(this)?'"'+this.replace(/\t/g,"\\t").replace(/\"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\v/g,"\\v").replace(/"/g,'\\"')+'"':0<=this.indexOf("'")?"'"+this.replace(/'/g,"''")+"'":this},String.prototype.regExpEscape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},RegExp.prototype.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},t=e._,r=Array.prototype,i=Object.prototype,d="undefined"!=typeof Symbol?Symbol.prototype:null,a=r.push,s=r.slice,f=i.toString,o=i.hasOwnProperty,n=Array.isArray,l=Object.keys,u=Object.create,c=function(){},p=function(e){return e instanceof p?e:this instanceof p?void(this._wrapped=e):new p(e)};"undefined"==typeof exports||exports.nodeType?e._=p:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=p),exports._=p),p.VERSION="1.9.1";var h,g=function(a,o,e){if(void 0===o)return a;switch(null==e?3:e){case 1:return function(e){return a.call(o,e)};case 3:return function(e,t,n){return a.call(o,e,t,n)};case 4:return function(e,t,n,r){return a.call(o,e,t,n,r)}}return function(){return a.apply(o,arguments)}},m=function(e,t,n){return p.iteratee!==h?p.iteratee(e,t):null==e?p.identity:p.isFunction(e)?g(e,t,n):p.isObject(e)&&!p.isArray(e)?p.matcher(e):p.property(e)};p.iteratee=h=function(e,t){return m(e,t,1/0)};var y=function(a,o){return o=null==o?a.length-1:+o,function(){for(var e=Math.max(arguments.length-o,0),t=Array(e),n=0;n<e;n++)t[n]=arguments[n+o];switch(o){case 0:return a.call(this,t);case 1:return a.call(this,arguments[0],t);case 2:return a.call(this,arguments[0],arguments[1],t)}var r=Array(o+1);for(n=0;n<o;n++)r[n]=arguments[n];return r[o]=t,a.apply(this,r)}},v=function(e){if(!p.isObject(e))return{};if(u)return u(e);c.prototype=e;var t=new c;return c.prototype=null,t},C=function(t){return function(e){return null==e?void 0:e[t]}},b=function(e,t){return null!=e&&o.call(e,t)},E=function(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0},S=Math.pow(2,53)-1,I=C("length"),N=function(e){var t=I(e);return"number"==typeof t&&0<=t&&t<=S};p.each=p.forEach=function(e,t,n){var r,a;if(t=g(t,n),N(e))for(r=0,a=e.length;r<a;r++)t(e[r],r,e);else{var o=p.keys(e);for(r=0,a=o.length;r<a;r++)t(e[o[r]],o[r],e)}return e},p.map=p.collect=function(e,t,n){t=m(t,n);for(var r=!N(e)&&p.keys(e),a=(r||e).length,o=Array(a),i=0;i<a;i++){var l=r?r[i]:i;o[i]=t(e[l],l,e)}return o};var R=function(s){return function(e,t,n,r){var a=3<=arguments.length;return function(e,t,n,r){var a=!N(e)&&p.keys(e),o=(a||e).length,i=0<s?0:o-1;for(r||(n=e[a?a[i]:i],i+=s);0<=i&&i<o;i+=s){var l=a?a[i]:i;n=t(n,e[l],l,e)}return n}(e,g(t,r,4),n,a)}};p.reduce=p.foldl=p.inject=R(1),p.reduceRight=p.foldr=R(-1),p.find=p.detect=function(e,t,n){var r=(N(e)?p.findIndex:p.findKey)(e,t,n);if(void 0!==r&&-1!==r)return e[r]},p.filter=p.select=function(e,r,t){var a=[];return r=m(r,t),p.each(e,function(e,t,n){r(e,t,n)&&a.push(e)}),a},p.reject=function(e,t,n){return p.filter(e,p.negate(m(t)),n)},p.every=p.all=function(e,t,n){t=m(t,n);for(var r=!N(e)&&p.keys(e),a=(r||e).length,o=0;o<a;o++){var i=r?r[o]:o;if(!t(e[i],i,e))return!1}return!0},p.some=p.any=function(e,t,n){t=m(t,n);for(var r=!N(e)&&p.keys(e),a=(r||e).length,o=0;o<a;o++){var i=r?r[o]:o;if(t(e[i],i,e))return!0}return!1},p.contains=p.includes=p.include=function(e,t,n,r){return N(e)||(e=p.values(e)),("number"!=typeof n||r)&&(n=0),0<=p.indexOf(e,t,n)},p.invoke=y(function(e,n,r){var a,o;return p.isFunction(n)?o=n:p.isArray(n)&&(a=n.slice(0,-1),n=n[n.length-1]),p.map(e,function(e){var t=o;if(!t){if(a&&a.length&&(e=E(e,a)),null==e)return;t=e[n]}return null==t?t:t.apply(e,r)})}),p.pluck=function(e,t){return p.map(e,p.property(t))},p.where=function(e,t){return p.filter(e,p.matcher(t))},p.findWhere=function(e,t){return p.find(e,p.matcher(t))},p.max=function(e,r,t){var n,a,o=-1/0,i=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof e[0]&&null!=e)for(var l=0,s=(e=N(e)?e:p.values(e)).length;l<s;l++)null!=(n=e[l])&&o<n&&(o=n);else r=m(r,t),p.each(e,function(e,t,n){a=r(e,t,n),(i<a||a===-1/0&&o===-1/0)&&(o=e,i=a)});return o},p.min=function(e,r,t){var n,a,o=1/0,i=1/0;if(null==r||"number"==typeof r&&"object"!=typeof e[0]&&null!=e)for(var l=0,s=(e=N(e)?e:p.values(e)).length;l<s;l++)null!=(n=e[l])&&n<o&&(o=n);else r=m(r,t),p.each(e,function(e,t,n){((a=r(e,t,n))<i||a===1/0&&o===1/0)&&(o=e,i=a)});return o},p.shuffle=function(e){return p.sample(e,1/0)},p.sample=function(e,t,n){if(null==t||n)return N(e)||(e=p.values(e)),e[p.random(e.length-1)];var r=N(e)?p.clone(e):p.values(e),a=I(r);t=Math.max(Math.min(t,a),0);for(var o=a-1,i=0;i<t;i++){var l=p.random(i,o),s=r[i];r[i]=r[l],r[l]=s}return r.slice(0,t)},p.sortBy=function(e,r,t){var a=0;return r=m(r,t),p.pluck(p.map(e,function(e,t,n){return{value:e,index:a++,criteria:r(e,t,n)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};var k=function(i,t){return function(r,a,e){var o=t?[[],[]]:{};return a=m(a,e),p.each(r,function(e,t){var n=a(e,t,r);i(o,e,n)}),o}};p.groupBy=k(function(e,t,n){b(e,n)?e[n].push(t):e[n]=[t]}),p.indexBy=k(function(e,t,n){e[n]=t}),p.countBy=k(function(e,t,n){b(e,n)?e[n]++:e[n]=1});var T=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;p.toArray=function(e){return e?p.isArray(e)?s.call(e):p.isString(e)?e.match(T):N(e)?p.map(e,p.identity):p.values(e):[]},p.size=function(e){return null==e?0:N(e)?e.length:p.keys(e).length},p.partition=k(function(e,t,n){e[n?0:1].push(t)},!0),p.first=p.head=p.take=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[0]:p.initial(e,e.length-t)},p.initial=function(e,t,n){return s.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},p.last=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[e.length-1]:p.rest(e,Math.max(0,e.length-t))},p.rest=p.tail=p.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},p.compact=function(e){return p.filter(e,Boolean)};var j=function(e,t,n,r){for(var a=(r=r||[]).length,o=0,i=I(e);o<i;o++){var l=e[o];if(N(l)&&(p.isArray(l)||p.isArguments(l)))if(t)for(var s=0,u=l.length;s<u;)r[a++]=l[s++];else j(l,t,n,r),a=r.length;else n||(r[a++]=l)}return r};p.flatten=function(e,t){return j(e,t,!1)},p.without=y(function(e,t){return p.difference(e,t)}),p.uniq=p.unique=function(e,t,n,r){p.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=m(n,r));for(var a=[],o=[],i=0,l=I(e);i<l;i++){var s=e[i],u=n?n(s,i,e):s;t&&!n?(i&&o===u||a.push(s),o=u):n?p.contains(o,u)||(o.push(u),a.push(s)):p.contains(a,s)||a.push(s)}return a},p.union=y(function(e){return p.uniq(j(e,!0,!0))}),p.intersection=function(e){for(var t=[],n=arguments.length,r=0,a=I(e);r<a;r++){var o=e[r];if(!p.contains(t,o)){var i;for(i=1;i<n&&p.contains(arguments[i],o);i++);i===n&&t.push(o)}}return t},p.difference=y(function(e,t){return t=j(t,!0,!0),p.filter(e,function(e){return!p.contains(t,e)})}),p.unzip=function(e){for(var t=e&&p.max(e,I).length||0,n=Array(t),r=0;r<t;r++)n[r]=p.pluck(e,r);return n},p.zip=y(p.unzip),p.object=function(e,t){for(var n={},r=0,a=I(e);r<a;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n};var A=function(o){return function(e,t,n){t=m(t,n);for(var r=I(e),a=0<o?0:r-1;0<=a&&a<r;a+=o)if(t(e[a],a,e))return a;return-1}};p.findIndex=A(1),p.findLastIndex=A(-1),p.sortedIndex=function(e,t,n,r){for(var a=(n=m(n,r,1))(t),o=0,i=I(e);o<i;){var l=Math.floor((o+i)/2);n(e[l])<a?o=l+1:i=l}return o};var x=function(o,i,l){return function(e,t,n){var r=0,a=I(e);if("number"==typeof n)0<o?r=0<=n?n:Math.max(n+a,r):a=0<=n?Math.min(n+1,a):n+a+1;else if(l&&n&&a)return e[n=l(e,t)]===t?n:-1;if(t!=t)return 0<=(n=i(s.call(e,r,a),p.isNaN))?n+r:-1;for(n=0<o?r:a-1;0<=n&&n<a;n+=o)if(e[n]===t)return n;return-1}};p.indexOf=x(1,p.findIndex,p.sortedIndex),p.lastIndexOf=x(-1,p.findLastIndex),p.range=function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),a=Array(r),o=0;o<r;o++,e+=n)a[o]=e;return a},p.chunk=function(e,t){if(null==t||t<1)return[];for(var n=[],r=0,a=e.length;r<a;)n.push(s.call(e,r,r+=t));return n};var B=function(e,t,n,r,a){if(!(r instanceof t))return e.apply(n,a);var o=v(e.prototype),i=e.apply(o,a);return p.isObject(i)?i:o};p.bind=y(function(t,n,r){if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");var a=y(function(e){return B(t,a,n,this,r.concat(e))});return a}),p.partial=y(function(a,o){var i=p.partial.placeholder,l=function(){for(var e=0,t=o.length,n=Array(t),r=0;r<t;r++)n[r]=o[r]===i?arguments[e++]:o[r];for(;e<arguments.length;)n.push(arguments[e++]);return B(a,l,this,this,n)};return l}),(p.partial.placeholder=p).bindAll=y(function(e,t){var n=(t=j(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=p.bind(e[r],e)}}),p.memoize=function(r,a){var o=function(e){var t=o.cache,n=""+(a?a.apply(this,arguments):e);return b(t,n)||(t[n]=r.apply(this,arguments)),t[n]};return o.cache={},o},p.delay=y(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),p.defer=p.partial(p.delay,p,1),p.throttle=function(n,r,a){var o,i,l,s,u=0;a||(a={});var c=function(){u=!1===a.leading?0:p.now(),o=null,s=n.apply(i,l),o||(i=l=null)},e=function(){var e=p.now();u||!1!==a.leading||(u=e);var t=r-(e-u);return i=this,l=arguments,t<=0||r<t?(o&&(clearTimeout(o),o=null),u=e,s=n.apply(i,l),o||(i=l=null)):o||!1===a.trailing||(o=setTimeout(c,t)),s};return e.cancel=function(){clearTimeout(o),u=0,o=i=l=null},e},p.debounce=function(n,r,a){var o,i,l=function(e,t){o=null,t&&(i=n.apply(e,t))},e=y(function(e){if(o&&clearTimeout(o),a){var t=!o;o=setTimeout(l,r),t&&(i=n.apply(this,e))}else o=p.delay(l,r,this,e);return i});return e.cancel=function(){clearTimeout(o),o=null},e},p.wrap=function(e,t){return p.partial(t,e)},p.negate=function(e){return function(){return!e.apply(this,arguments)}},p.compose=function(){var n=arguments,r=n.length-1;return function(){for(var e=r,t=n[r].apply(this,arguments);e--;)t=n[e].call(this,t);return t}},p.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},p.before=function(e,t){var n;return function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},p.once=p.partial(p.before,2),p.restArguments=y;var O=!{toString:null}.propertyIsEnumerable("toString"),w=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],F=function(e,t){var n=w.length,r=e.constructor,a=p.isFunction(r)&&r.prototype||i,o="constructor";for(b(e,o)&&!p.contains(t,o)&&t.push(o);n--;)(o=w[n])in e&&e[o]!==a[o]&&!p.contains(t,o)&&t.push(o)};p.keys=function(e){if(!p.isObject(e))return[];if(l)return l(e);var t=[];for(var n in e)b(e,n)&&t.push(n);return O&&F(e,t),t},p.allKeys=function(e){if(!p.isObject(e))return[];var t=[];for(var n in e)t.push(n);return O&&F(e,t),t},p.values=function(e){for(var t=p.keys(e),n=t.length,r=Array(n),a=0;a<n;a++)r[a]=e[t[a]];return r},p.mapObject=function(e,t,n){t=m(t,n);for(var r=p.keys(e),a=r.length,o={},i=0;i<a;i++){var l=r[i];o[l]=t(e[l],l,e)}return o},p.pairs=function(e){for(var t=p.keys(e),n=t.length,r=Array(n),a=0;a<n;a++)r[a]=[t[a],e[t[a]]];return r},p.invert=function(e){for(var t={},n=p.keys(e),r=0,a=n.length;r<a;r++)t[e[n[r]]]=n[r];return t},p.functions=p.methods=function(e){var t=[];for(var n in e)p.isFunction(e[n])&&t.push(n);return t.sort()};var L=function(s,u){return function(e){var t=arguments.length;if(u&&(e=Object(e)),t<2||null==e)return e;for(var n=1;n<t;n++)for(var r=arguments[n],a=s(r),o=a.length,i=0;i<o;i++){var l=a[i];u&&void 0!==e[l]||(e[l]=r[l])}return e}};p.extend=L(p.allKeys),p.extendOwn=p.assign=L(p.keys),p.findKey=function(e,t,n){t=m(t,n);for(var r,a=p.keys(e),o=0,i=a.length;o<i;o++)if(t(e[r=a[o]],r,e))return r};var H,D,q=function(e,t,n){return t in n};p.pick=y(function(e,t){var n={},r=t[0];if(null==e)return n;p.isFunction(r)?(1<t.length&&(r=g(r,t[1])),t=p.allKeys(e)):(r=q,t=j(t,!1,!1),e=Object(e));for(var a=0,o=t.length;a<o;a++){var i=t[a],l=e[i];r(l,i,e)&&(n[i]=l)}return n}),p.omit=y(function(e,n){var t,r=n[0];return p.isFunction(r)?(r=p.negate(r),1<n.length&&(t=n[1])):(n=p.map(j(n,!1,!1),String),r=function(e,t){return!p.contains(n,t)}),p.pick(e,r,t)}),p.defaults=L(p.allKeys,!0),p.create=function(e,t){var n=v(e);return t&&p.extendOwn(n,t),n},p.clone=function(e){return p.isObject(e)?p.isArray(e)?e.slice():p.extend({},e):e},p.tap=function(e,t){return t(e),e},p.isMatch=function(e,t){var n=p.keys(t),r=n.length;if(null==e)return!r;for(var a=Object(e),o=0;o<r;o++){var i=n[o];if(t[i]!==a[i]||!(i in a))return!1}return!0},H=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var a=typeof e;return("function"===a||"object"===a||"object"==typeof t)&&D(e,t,n,r)},D=function(e,t,n,r){e instanceof p&&(e=e._wrapped),t instanceof p&&(t=t._wrapped);var a=f.call(e);if(a!==f.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return d.valueOf.call(e)===d.valueOf.call(t)}var o="[object Array]"===a;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var i=e.constructor,l=t.constructor;if(i!==l&&!(p.isFunction(i)&&i instanceof i&&p.isFunction(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var s=(n=n||[]).length;s--;)if(n[s]===e)return r[s]===t;if(n.push(e),r.push(t),o){if((s=e.length)!==t.length)return!1;for(;s--;)if(!H(e[s],t[s],n,r))return!1}else{var u,c=p.keys(e);if(s=c.length,p.keys(t).length!==s)return!1;for(;s--;)if(u=c[s],!b(t,u)||!H(e[u],t[u],n,r))return!1}return n.pop(),r.pop(),!0},p.isEqual=function(e,t){return H(e,t)},p.isEmpty=function(e){return null==e||(N(e)&&(p.isArray(e)||p.isString(e)||p.isArguments(e))?0===e.length:0===p.keys(e).length)},p.isElement=function(e){return!(!e||1!==e.nodeType)},p.isArray=n||function(e){return"[object Array]"===f.call(e)},p.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},p.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){p["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),p.isArguments(arguments)||(p.isArguments=function(e){return b(e,"callee")});var U=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof U&&(p.isFunction=function(e){return"function"==typeof e||!1}),p.isFinite=function(e){return!p.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},p.isNaN=function(e){return p.isNumber(e)&&isNaN(e)},p.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===f.call(e)},p.isNull=function(e){return null===e},p.isUndefined=function(e){return void 0===e},p.has=function(e,t){if(!p.isArray(t))return b(e,t);for(var n=t.length,r=0;r<n;r++){var a=t[r];if(null==e||!o.call(e,a))return!1;e=e[a]}return!!n},p.noConflict=function(){return e._=t,this},p.identity=function(e){return e},p.constant=function(e){return function(){return e}},p.noop=function(){},p.property=function(t){return p.isArray(t)?function(e){return E(e,t)}:C(t)},p.propertyOf=function(t){return null==t?function(){}:function(e){return p.isArray(e)?E(t,e):t[e]}},p.matcher=p.matches=function(t){return t=p.extendOwn({},t),function(e){return p.isMatch(e,t)}},p.times=function(e,t,n){var r=Array(Math.max(0,e));t=g(t,n,1);for(var a=0;a<e;a++)r[a]=t(a);return r},p.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},p.now=Date.now||function(){return(new Date).getTime()};var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=p.invert(M),V=function(t){var n=function(e){return t[e]},e="(?:"+p.keys(t).join("|")+")",r=RegExp(e),a=RegExp(e,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(a,n):e}};p.escape=V(M),p.unescape=V(P),p.result=function(e,t,n){p.isArray(t)||(t=[t]);var r=t.length;if(!r)return p.isFunction(n)?n.call(e):n;for(var a=0;a<r;a++){var o=null==e?void 0:e[t[a]];void 0===o&&(o=n,a=r),e=p.isFunction(o)?o.call(e):o}return e};var _=0;p.uniqueId=function(e){var t=++_+"";return e?e+t:t},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\u2028|\u2029/g,Y=function(e){return"\\"+Q[e]};p.template=function(o,e,t){!e&&t&&(e=t),e=p.defaults({},e,p.templateSettings);var n,r=RegExp([(e.escape||J).source,(e.interpolate||J).source,(e.evaluate||J).source].join("|")+"|$","g"),i=0,l="__p+='";o.replace(r,function(e,t,n,r,a){return l+=o.slice(i,a).replace($,Y),i=a+e.length,t?l+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":n?l+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(l+="';\n"+r+"\n__p+='"),e}),l+="';\n",e.variable||(l="with(obj||{}){\n"+l+"}\n"),l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{n=new Function(e.variable||"obj","_",l)}catch(e){throw e.source=l,e}var a=function(e){return n.call(this,e,p)},s=e.variable||"obj";return a.source="function("+s+"){\n"+l+"}",a},p.chain=function(e){var t=p(e);return t._chain=!0,t};var W=function(e,t){return e._chain?p(t).chain():t};p.mixin=function(n){return p.each(p.functions(n),function(e){var t=p[e]=n[e];p.prototype[e]=function(){var e=[this._wrapped];return a.apply(e,arguments),W(this,t.apply(p,e))}}),p},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=r[t];p.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],W(this,e)}}),p.each(["concat","join","slice"],function(e){var t=r[e];p.prototype[e]=function(){return W(this,t.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},p.prototype.valueOf=p.prototype.toJSON=p.prototype.value,p.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}();